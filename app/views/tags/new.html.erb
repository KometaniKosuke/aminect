<% parents = Tag.where(ancestry: nil) %>
<% i=12 %>
<%= form_tag( {:controller => 'tags', :action => 'create'},{ :method => :post} ) do %>
  <% parents.each do |pa| %>
    <div id="accordion" class="accordion-container">
      <h4 class="accordion-title js-accordion-title"><%= pa.name %></h4>

      <% cs = Tag.where(ancestry: pa.id.to_s) %>
      <div class="accordion-content">
        <% cs.each do |c| %>
          <% i += 1 %>
          <p><%= check_box "tag", i.to_s, { checked: UserTag.find_by(user_id: current_user.id, tag_id: i).present? } %><%= c.name %></p>
        <% end %>
      </div>

    </div>
  <% end %>
  <%= submit_tag "登録", class: "tag-btn" %>
<% end %>

<% if @tags.present? %>
<%= @tags.reject{ @altags } %><br>
選んだタグ<%= @tags %><br>
既にあるタグ<%= @altags %><br>
<% end %>

<br><br>
